; PlatformIO Configuration for ESP32-S2 Precision Digital Multimeter
; Target Hardware: ESP32-S2FN4R2 (Lolin S2 Mini)
; Project: Omnimeter - Production Firmware
;
; Usage:
;   Serial upload:  pio run -e lolin_s2_mini --target upload
;   OTA upload:     pio run -e lolin_s2_mini_ota --target upload
;   Upload FS:      pio run -e lolin_s2_mini --target uploadfs

[env]
platform = espressif32
board = lolin_s2_mini
framework = arduino

; Serial monitor configuration (USB CDC)
monitor_speed = 115200
monitor_rts = 0
monitor_dtr = 0

; Build flags for optimizations and warnings
build_flags = 
    -DCORE_DEBUG_LEVEL=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -Wall
    -O2
    ; WiFi credentials - override via environment or platformio_override.ini
    ; Create platformio_override.ini with your credentials:
    ; [env:lolin_s2_mini]
    ; build_flags = ${env.build_flags}
    ;     -DWIFI_AP_SSID='"MyNetwork"'
    ;     -DWIFI_AP_PASSWORD='"MyPassword"'
    ;     -DWIFI_STA_SSID='"HomeNetwork"'
    ;     -DWIFI_STA_PASSWORD='"HomePassword"'
    ${sysenv.BUILD_FLAGS}

; Filesystem for web interface (LittleFS)
board_build.filesystem = littlefs
board_build.partitions = default.csv

; Library dependencies - use specific versions for ESP32
lib_deps = 
    mathieucarbou/ESP Async WebServer @ ^3.0.6
    mathieucarbou/Async TCP @ ^3.1.4

; ============================================================================
; Environment: Serial Upload (default - use for initial programming)
; ============================================================================
[env:lolin_s2_mini]
upload_speed = 921600

; ============================================================================
; Environment: OTA Upload (use after initial programming)
; ============================================================================
[env:lolin_s2_mini_ota]
upload_protocol = espota
upload_port = omnimeter.local
upload_flags = --auth=omnimeter
